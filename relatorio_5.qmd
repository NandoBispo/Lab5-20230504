---
title: "LABORATÓRIO 5: Regressão Linear"
author: "Fernado Bispo, Jeff Caponero"
format:
    pdf:
      toc: true
      toc-title: Sumário
      colorlinks: true
      documentclass: report
      papersize: letter
      number-sections: false
      geometry:
        - top=30mm
        - left=30mm
        - right=20mm
        - bottom=20mm
        - heightrounded
      fig-pos: "H"
      fig-align: center
      lang: pt-BR
      # fontfamily: libertinus
      fontsize: 12pt
      include-in-header:
      - text: |
          \usepackage{caption}
          \usepackage{fontspec}
          \usepackage{xcolor}
          \usepackage{indentfirst}
          \captionsetup[table]{name=Tabela}
---

```{r pacotes}
#| echo: false
#| warning: false


# PACOTES ----

if (!require(pacman)) install.packages("pacman")

pacman::p_load(tidyverse,  janitor, stargazer,  sjmisc, summarytools,
               kableExtra, moments, ggpubr, formattable, gridExtra, 
               glue, corrplot, sessioninfo, readxl, writexl, ggthemes,
               patchwork,  plotly, lmtest, olsrr, gglm, ggplot2,
               tidymodels, GGally, skimr, performance)

``` 

# Introdução

O laboratório desta semana está subdividido em duas partes com análises de dois conjuntos de dados distintos que visa a continuidade da aplicação das técnicas de Regressão Linear Simples com a aplicabilidade das técnicas de análise de resíduos e transformação de variáveis inclusive.
Para melhor desenvolvimento do processo de analise, este relatório foi dividido em duas partes contendo as análises de cada um dos conjuntos de dados e contando com suas respectivas apresentações sobre o contexto a ser analisado.


# Parte 1: Regressão Linear Simples - Diagnóstico do modelo

```{r dados1}
#| echo: false
#| warning: false

## DADOS 1 ----

dados1 <- datasets::trees

dados1 <- dados1|>
  janitor::clean_names()

## Conversão de unidades
dados1 <- dados1|>
  mutate(
    height = height*0.3048,
    volume = volume*0.02831685,
    girth = girth*0.3048
  )
```



## Metodologia

O conjunto de dados *trees*, disponível no pacote *datasets*, contém informações de 31 cerejeiras (*Black cherry*) da Floresta Nacional de Allegheny, relativas a três características:

- Volume de madeira útil (em metros cúbicos (m³)); 
- Altura (em metros (m));
- Circunferência (em metros(m)) a 1,37 de altura.

Para esta atividade **serão considerados apenas as informações referentes ao volume e altura das árvores**. Com base nestes dados se desenvolverá:

(a) Ajuste um modelo linear simples para volume como função da altura da árvore;
(b) Avalação gráfica dos resíduos Jacknife para diagnóstico do modelo ajustado;
(c) Transformações das característricas;
(d) Avaliação da transformação mais apropriada dentro da família proposta por Box e
Cox;
(e) Indicação da melhor transformação analisada.


```{r dispersao+ajuste}
#| echo: false
#| warning: false
#| fig-height: 4
#| fig-width: 7


### Ajuste do Modelo + Gráfico ----
dados1|>
  ggplot(aes(x = height, y = volume)) +
  geom_point(
    color = "#234B6E"
    )+
  labs(
    title = "Figura 1: Modelo Ajustado entre o Volume e Altura",
    y = 'Volume (m³)',
    x = 'Altura (m)'
  )+
  ggpubr::stat_cor(
    aes(label = paste(..r.label.., ..rr.label.., ..p.label.., sep = "~`; `~")),
    cor.coef.name = c("R"),
    label.sep = "; ", geom = "text",
    color="red",
    method = "pearson",
    label.x = 19.2, label.y = 2, show.legend = F,
    p.accuracy = 0.001, r.accuracy = 0.0001,
    size = 3)+
  ggpubr::stat_regline_equation(
      aes(label = paste(..eq.label.., ..adj.rr.label.., sep = "~`; `~")),
          geom = "text", label.x = 19.2, label.y = 1.75, 
      position = "identity", 
      color="red",
      size = 3, show.legend = F
  )+
  geom_smooth(
    method=lm, se=T, formula = "y ~ x", color = "tomato")+
  theme_minimal()+
  scale_x_continuous(breaks = seq(19,27,1))+
  scale_y_continuous(
  breaks = seq(0, 2.5, 0.5),
    labels = scales::number_format(
      big.mark = ".",
      decimal.mark = ","
    ))+
    theme(legend.position = "none",
          axis.line = element_line(size = 0.8, color = "#222222"))

## Modelo Ajustado
mFit1 <- lm(volume~height, data = dados1)

```



# Parte 2: Regressão Linear Múltipla - Estimação pontual

